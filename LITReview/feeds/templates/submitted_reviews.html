{% extends 'partials/base.html' %}
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>{% block title %}LITReview Home{% endblock %}</title>
</head>
<body>
{% block content %}
<style>
    a {color: darkgreen;}
    #ticket_title {
      background: lightblue;}
    #ticket_user {
      background: pink;}
    #ticket_time_created {
      background: lightgreen;}
    #ticket_description {
      background: #FED8B1;}
    #review_datas {
      background: #DCDCDC;}
    #review_user {
      background: pink;}
    #review_time_created {
      background: lightgreen;}
    #review_rating {
      background: lightblue;}
</style>
    <div><h4>Welcome {{user}}, here is the tickets list, <br>
    from which you submitted your reviews. </h4></div><hr>
    {% if not reviewed_tickets %}
        <a href="{% url 'index' %}">
        <b>There isn't any ticket that you reviewed yet, so take a look on the tickets here. </b></a>
    {% endif %}
    {% for ticket in reviewed_tickets %}
        <div><i id="ticket_user">From {{ ticket.user }}, </i>
        <i id="ticket_time_created">at {{ ticket.time_created }} </i>
        <i id="ticket_title" >for {{ ticket.title }}. </i>
        <i id="ticket_description">Query : {{ ticket.description }} </i>
        {% for review in reviews %}
            {% if forloop.counter == reviews|length %}
                <div class="spoiler">
                <b>Click here to add reviews to this ticket in addition to those you already submitted. </b>
                <div style="visibility:hidden;height:0">
                {% include 'review_form_2.html' with ticket_id=ticket.id %}</div></div>
            {% endif %}
        {% endfor %}
        <details><summary>Click here to see the reviews that you submitted for this ticket. </summary>
        {% for review in reviews %}
            {% with ticket as ticket %}
            {% with review as review %}
                <div id="review_datas">{% include 'included_reviews_2.html' %}</div>
            {% endwith %}
            {% endwith %}
        {% endfor %}
        </details><hr></div>
    {% endfor %}
<script>
    var spoilers = document.getElementsByClassName("spoiler");
    var spoilClick = function(){
        pchild=this.getElementsByTagName('div');
        if(pchild[0].style.visibility!='hidden'){
            pchild[0].style.visibility='hidden';
            pchild[0].style.height='0';
        }else{
            pchild[0].style.visibility=''; pchild[0].style.height=''
        }
    }
    for (var i = 0; i < spoilers.length; i++) {
    spoilers[i].addEventListener('click', spoilClick, false);
    }
</script>
{% endblock %}
</body>
</html>